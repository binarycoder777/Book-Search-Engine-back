var g_ischina=!0,g_forced=!1,g_device="pc",g_ip="",g_parsed=[],dls_show=[],g_wxp_svi="all",g_prom_mark="",previous_search="",current_search="",log_enabled=!1;function c_log(e){log_enabled&&console.log(e)}function share_record(e,t){return e&&link_clicked(t),!1}function cronjob(){var e=new XMLHttpRequest;return e.open("POST","cronjob.php",!0),e.setRequestHeader("Content-type","application/x-www-form-urlencoded"),e.setRequestHeader("X-Requested-With","XMLHttpRequest"),e.send(),!1}function areCookiesEnabled(){try{document.cookie="cookietest=1";var e=-1!==document.cookie.indexOf("cookietest=");return document.cookie="cookietest=1; expires=Thu, 01-Jan-1970 00:00:01 GMT",e}catch(e){return!1}}function Pageloaded(){weixinTip(),cronjob(),wechat_overlay_load(),"mobile"===g_device&&show_notification();return areCookiesEnabled()&&preload_jmwxsi(),preload_country(),google_analytics(),setCookie("loaded",g_loaded_plus,30),"pc"===g_device&&null!==document.getElementById("SearchWord")&&document.getElementById("SearchWord").focus(),adjust_screen(),!1}function adjust_screen(){var e,t=window.innerHeight;"pc"===g_device&&689<t&&(e=t-159,document.getElementById("google-div").setAttribute("style","height:"+e+"px;"),document.getElementById("forum-div").setAttribute("style","max-height:"+e+"px;"))}function weixinTip(){var e=navigator.userAgent,t=!!/MicroMessenger/i.test(e);/iPhone OS/i.test(e);t&&(document.getElementById("JweixinTip").style.display="block",document.getElementById("wxtip-txt").innerHTML="请点击右上角<br/>选择在浏览器中打开")}function google_analytics(){var e,t,n,o;e=window,t=document,o="script",n="ga",e.GoogleAnalyticsObject=n,e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=+new Date,n=t.createElement(o),o=t.getElementsByTagName(o)[0],n.async=1,n.src="//www.google-analytics.com/analytics.js",o.parentNode.insertBefore(n,o),ga("create","UA-63432350-1","auto"),ga("send","pageview")}function setCookie(e,t,n){var o=new Date;o.setTime(o.getTime()+24*n*60*60*1e3);o="expires="+o.toUTCString();document.cookie=e+"="+t+"; "+o}function getCookie(e){for(var t=e+"=",n=decodeURIComponent(document.cookie).split(";"),o=0;o<n.length;o++){for(var i=n[o];" "==i.charAt(0);)i=i.substring(1);if(0===i.indexOf(t))return i.substring(t.length,i.length)}return""}function themeChanged(){var e=document.getElementById("theme");return current_theme="dark"===current_theme?"bright":"dark",setCookie("theme",current_theme,30),e.setAttribute("href","Style/Main_"+current_theme+".css"+g_css_appendix),link_clicked("theme changed to "+current_theme),!1}function load_mainpage(){var e=document.getElementById("main-form").getAttribute("class");return"mainform_search"===e?window.location=window.location.pathname:"mainform"!==e||0<(e=g_image_link).length&&window.open(e,"_blank"),!1}function focusinput(){"mobile"===g_device&&validate("");var e=document.getElementById("SearchWord");return e.removeAttribute("onfocus"),e.focus(),!0}function status_result(e,t,n,o,i,r){var a=new XMLHttpRequest;return a.open("POST","status_result.php",!0),a.setRequestHeader("Content-type","application/x-www-form-urlencoded"),a.setRequestHeader("X-Requested-With","XMLHttpRequest"),a.send("action="+encodeURIComponent(e)+"&c="+encodeURIComponent(t)+"&q="+encodeURIComponent(n)+"&status="+encodeURIComponent(o)+"&log="+encodeURIComponent(i)+"&data_length="+encodeURIComponent(r)),!1}function link_clicked(e){var t=new XMLHttpRequest;return t.open("POST","link_clicked.php",!0),t.setRequestHeader("Content-type","application/x-www-form-urlencoded"),t.setRequestHeader("X-Requested-With","XMLHttpRequest"),t.send("q="+encodeURIComponent(e)),!1}function preload_jmwxsi(){var t=new XMLHttpRequest;return t.onreadystatechange=function(){var e;4===t.readyState&&200===t.status&&(e=t.responseText,g_wxp_svi=e),4===t.readyState&&500<=t.status&&c_log("preload_jmwxsi request network fail")},t.open("POST","/wxpush/preload_jmwxsi.php",!0),t.setRequestHeader("Content-type","application/x-www-form-urlencoded"),t.setRequestHeader("X-Requested-With","XMLHttpRequest"),t.send("jmwxsi="+encodeURIComponent(getCookie("jmwxsi"))+"&g_device="+g_device),c_log("preloading jmwxsi"),!1}function preload_country(){var e=new XMLHttpRequest;return e.onreadystatechange=function(){4===e.readyState&&200===e.status&&"CN"!==e.responseText&&(g_ischina=!1),4===e.readyState&&500<=e.status&&c_log("preload_country request network fail")},e.open("POST","/IpGeo/preload_country.php",!0),e.setRequestHeader("Content-type","application/x-www-form-urlencoded"),e.setRequestHeader("X-Requested-With","XMLHttpRequest"),e.send(),c_log("preloading country"),!1}function get_abuse_wrapper(e){var t="";return e&&(t='<span style="margin-left: 10px;"><a target="_blank" href="/report_abuse.php?url='+encodeURIComponent(e)+'" style="color: grey;font-size: 12px;">举报</a></span>'),t}window.alert=function(){},g_device=700<window.innerWidth?"pc":"mobile";var g_word="",status_hub=[],status_hub_count=0,g_id=-1,hsp_arr=window.location.hostname.split("."),hs_base="."+hsp_arr[hsp_arr.length-2]+"."+hsp_arr[hsp_arr.length-1],g_hostname_arr=["www"+hs_base,"www2.jiumodiary.com","www5.jiumodiary.com"];function ajax_fetch_hub(a,e){for(var l=!1,t=[],n=0;n<g_hostname_arr.length;n++){var o=g_hostname_arr[n];t[o]=new XMLHttpRequest,t[o].onreadystatechange=function(i,r){return function(){var e,t,n,o;4===r.readyState&&200===r.status&&(l?c_log("abandant ajax "+i):(l=!0,g_id===a&&(n=r.responseText,e=(o=JSON.parse(n)).status,t=o.status_extra,n=o.log,status_hub_count=parseInt(o.count),o=o.sources,c_log(e+": "+n+", new_count:"+status_hub_count),"succeed"===e&&(status_hub=status_hub.concat(o),"completed"!==t&&ajax_fetch_hub(a,status_hub_count)),render(t))))}}(o,t[o]),t[o].open("POST","https://"+o+"/ajax_fetch_hubs.php",!0),t[o].setRequestHeader("Content-type","application/x-www-form-urlencoded"),t[o].setRequestHeader("X-Requested-With","XMLHttpRequest"),t[o].send("id="+encodeURIComponent(a)+"&set="+encodeURIComponent(e)),c_log("ajax request : "+o+", id="+encodeURIComponent(a)+"&set="+encodeURIComponent(e))}}function init_fetch_hub(e){for(var t=(new Date).getTime(),i=!1,n=[],o=0;o<g_hostname_arr.length;o++){var r=g_hostname_arr[o];n[r]=new XMLHttpRequest,n[r].onreadystatechange=function(n,o){return function(){if(4===o.readyState&&200===o.status)if(i)c_log("abandant init "+n);else{i=!0;var e=o.responseText,t=JSON.parse(e),e=t.status;if("succeed"!==e)return hide_loading(),"exceed"===e?void exceed_alert():"tooshort"===e?void tooshort_alert():void notfound_alert();status_hub=t.sources,status_hub_count=parseInt(t.count),c_log("g_id received: "+(g_id=t.id)),ajax_fetch_hub(g_id,status_hub_count),render("more")}}}(r,n[r]),n[r].open("POST","https://"+r+"/init_hubs.php",!0),n[r].setRequestHeader("Content-type","application/x-www-form-urlencoded"),n[r].setRequestHeader("X-Requested-With","XMLHttpRequest"),n[r].send("q="+encodeURIComponent(e)+"&remote_ip="+g_ip+"&time_int="+t),c_log("init request : "+r+",  q="+encodeURIComponent(e)+"&remote_ip="+g_ip+"&time_int="+t)}}function render(e){c_log("render - "+e+" - "+status_hub_count),("completed"!==e?more_loading:hide_loading)(),view=[],uls=[],("mobile"===g_device?render_mobile:render_normal)(),localbook_refresh(),"completed"===e&&0===view.length&&notfound_alert()}function render_mobile(){for(var e in status_hub){var t=status_hub[e].view_type;if("succeed"===status_hub[e].details.status){var n=status_hub[e].details.data;switch(t){case"view_forum":for(var o in n){var i=n[o].data;for(r in i)i[r].info=status_hub[e].info,i[r].view_type=t;push_view_main(i)}break;case"view_local":n=n.slice(0,1);default:for(var r in n)n[r].info=status_hub[e].info,n[r].view_type=t;push_view_main(n)}}}}function render_normal(){for(var e in status_hub){var t=status_hub[e].view_type;if("succeed"===status_hub[e].details.status){var n=status_hub[e],o=status_hub[e].details.data;switch(t){case"view_forum":case"view_sidebar":split_panel(),push_view_sidebar(n);break;default:for(var i in o)o[i].info=status_hub[e].info,o[i].view_type=t;push_view_main(o)}}}}function startsearch(){var e=document.getElementById("SearchWord").value;return 0===e.length||e===previous_search||(validate(current_search=e),previous_search=e,setTimeout(function(){previous_search=""},2e3)),!1}function show_notification(){var e=document.getElementById("notification");e&&(e.style.display="block")}function hide_notification(){var e=document.getElementById("notification");e&&(e.style.display="none")}function validate(e){hide_notification(),document.getElementById("SearchWord").blur();var t=document.getElementById("SearchButton"),n=document.getElementById("loading-icon"),o=document.getElementById("result-panel"),i=document.getElementById("result-panel-middle"),r=document.getElementById("google-div"),a=(document.getElementById("google-result-div"),document.getElementById("format-filter")),l=document.getElementById("google-panel"),s=document.getElementById("forum-panel-not-ads"),d=document.getElementById("forum-div"),c=document.getElementById("main-form"),u=document.getElementById("row-1"),p=document.getElementById("row-2"),m=document.getElementById("row-3"),_=(document.getElementById("row-1-link"),document.getElementById("icon-wrapper")),g=document.getElementById("theme-div"),h=document.getElementById("logo"),f=document.getElementById("label-div");return document.documentElement.scrollTop=0,document.body.scrollTop=0,c.setAttribute("class","mainform_search"),u.setAttribute("class","row1_search"),p.setAttribute("class","row2_search"),m.setAttribute("class","row3_search"),h.style.display="none",f.style.display="none",i.setAttribute("class","result-panel-middle-hide"),l.setAttribute("class","google-panel-width"),d.innerHTML="",d.style.display="none",s.style.display="none",a.style.display="none",a.innerHTML="",o.style.display="",r.style.display="",_.appendChild(g),_.setAttribute("class","row4_search"),document.getElementById("result-ul").innerHTML="",g_parsed=[],status_hub=[],fetched=[],hub_word=e,g_id=-1,view=[],dls_show=[],uls=[],"mobile"===g_device&&(t.innerHTML=""),""!==e&&(n.style.display="",init_fetch_hub(e)),!1}var format=["PDF","TXT","MOBI","EPUB","AZW","DOC"],format_exp=[/pdf/i,/txt/i,/mobi(?!le)/i,/epub/i,/azw/i,/doc(?!ument)/i],format_other="OTHER";function get_format_exp(e){for(var t=0;t<format.length;t++)if(format[t].toUpperCase()===e.toUpperCase())return format_exp[t];return!1}var format_sum=[];function addto_format_sum(e){for(var t=0;t<format_sum.length;t++)if(format_sum[t][0]===e)return format_sum[t][1]+=1,!1;format_sum.push([e,1])}function is_show_barcode(e){if(!g_ischina)return!1;if("all"===g_wxp_svi)return!1;var t=["474b.com","t00y.com","pan.baidu","yun.baidu","haodoo"],n=["474b.com","t00y.com","pan.baidu","yun.baidu","haodoo"];if("pc"===g_device){for(var o=0;o<t.length;o++)if(0<=e.indexOf(t[o]))return!0}else for(o=0;o<n.length;o++)if(0<=e.indexOf(n[o]))return!0;return!1}function is_zip_rar(e){return-1!==e.indexOf(".rar",e.length-".rar".length)||-1!==e.indexOf(".zip",e.length-".zip".length)}function render_main(e){var t="";if("view_local"===e.view_type)return t;if("img_link"in e)return t+='<li style="list-style:none; line-height:1.2; margin-bottom:10px;">',t+='<div style="display: inline-block;max-width: 70px; width:20%; line-height:87px;height:90px;text-align:center;border: 1px solid rgba(128,128,128,0.5);">',t+='<a rel="noreferrer external nofollow" href="'+e.link+'" target="_blank"><img src="'+e.img_link+'" style="vertical-align: middle; max-width:100%; max-height:100%"></a></div>',t+='<div class="priced_item_left" style="margin-left:1%; width:78%">',t+='<div class="title" style="line-height:1.5em; max-height:1.5em;"><a rel="noreferrer external nofollow" target="_blank" href="'+e.link+'"><span width="100%" style="font-size: 18px;font-family: arial,sans-serif;">'+e.title+"</span></a></div>","v_right1"in e?t+='<div style="line-height:1.3em; max-height:2.5em;">':t+='<div style="line-height:1.3em; max-height:3.7em;">',t+=e.v_des.replace("<br>",". ")+"</div>","v_right1"in e&&(t+='<div><span style="display:inline-block; margin-top:2px; margin-bottom:2px;">',"v_right2"in e&&("v_right2_link"in e?t+='<a rel="noreferrer external nofollow" target="_blank" href="'+e.v_right2_link+'"><span style="background-color: #A0522D;font-size: small;color: white;padding: 0px 2px; margin-right:5px; border-radius: 2px 2px;">'+e.v_right2+"</span></a>":t+='<span style="background-color: #A0522D;font-size: small; color: white;padding: 0px 2px; margin-right:5px; border-radius: 2px 2px;">'+e.v_right2+"</span>"),t+='<span style="background-color: #A0522D;font-size: small; color: white;padding: 0px 2px; border-radius: 2px 2px;">'+e.v_right1+"</span>",t+="</span></div>"),t+='<div class="span-host" style="font-weight: bold; font-size: 14px;">'+e.host+get_abuse_wrapper(e.link)+"</div></div>",t+="</li>";var n=e.title,o=e.des;return e.replaced_title&&(n=e.replaced_title),e.replaced_des&&(o=e.replaced_des),t+='<div><a style="cursor: pointer;" data-title="'+e.title+'" data-href="'+e.link+'" onclick="wxp_overlay_show(this);"><span style="font-size: 18px; font-family: arial,sans-serif;">'+n+"</span></a></div>",t+='<div class="span-des" >'+o+"</div>",t+='<div class="span-host" style="font-weight: bold; font-size: 13px;">'+e.host+get_abuse_wrapper(e.link)+"</div>",t+="</div></li>"}var view=[],format_sum=[];function push_view_main(e){for(var t=document.getElementById("result-ul"),n="",o=0;o<e.length;o++){e[o].rate_summary=parseInt(e[o].rate_summary),e[o].pos=view.length+o;for(var i=!1,r=0;r<view.length;r++)if(e[o].link===view[r].link){view[r].info+="; "+e[o].info,i=!0;break}i||view.push(e[o])}if(view.sort(function(e,t){return 1e3*(t.rate_summary-e.rate_summary)+(e.pos-t.pos)}),0===view.length)return!1;for(o=0;o<view.length;o++)view[o].log="",log_enabled&&(view[o].log=" - "+view[o].info+" - "+view[o].rate_title+"|"+view[o].rate_des+" - "+view[o].rate_summary),n+=render_main(view[o]);t.innerHTML=n,format_sum=[];for(o=0;o<view.length;o++){view[o].des||(view[o].des="");for(var a=!1,r=0;r<format.length;r++)(view[o].title.match(format_exp[r])||view[o].des.match(format_exp[r]))&&(addto_format_sum(format[r]),a=!0);a||addto_format_sum(format_other)}format_sum.sort(function(e,t){return e[0]===format_other?1:t[0]===format_other?-1:t[1]-e[1]});var t=document.getElementById("format-filter"),l=[];if(2<=format_sum.length){for(o=0;o<format_sum.length;o++){var s='<a id="'+format_sum[o][0]+'" href="#" onclick="return filter_content(\''+format_sum[o][0]+"')\">"+format_sum[o][0]+"("+format_sum[o][1]+")</a>";l.push(s)}s=l.join(" | ");t.innerHTML=s}}var uls=[];function push_view_sidebar(e){"view_forum"===e.view_type&&uls.push([e.view_type_sidebar_priority,generate_ul_forum(e)]),"view_sidebar"===e.view_type&&uls.push([e.view_type_sidebar_priority,generate_ul_sidebar(e)]),uls.sort(function(e,t){return parseInt(e[0])-parseInt(t[0])});for(var t="",n=0;n<uls.length;n++)t+=uls[n][1];document.getElementById("forum-div").innerHTML=t}function generate_ul_forum(e){var t,n=e.details.data,o='<div style="color: rgb(221, 221, 221); margin-top: 15px; margin-left: 10px; margin-right: 10px;">';for(t in n){var i=n[t].title,r=n[t].data;if(r){for(var e in o+='<span class="span-host">'+i+":</span>",o+="<ul>",r)o+='<li><a style="cursor: pointer;" data-title="'+r[e].title+'" data-href="'+r[e].link+'" onclick="wxp_overlay_show(this);"><span style="font-size: 13px; font-family: arial,sans-serif;">'+r[e].title+"</span></a></li>";o+="</ul>"}}return o+="</div>"}function generate_ul_sidebar(e){var t=e.details.data,n='<div style="color: rgb(221, 221, 221); margin-top: 15px; margin-left: 10px; margin-right: 10px;">';e.view_host_link?n+='<a rel="noreferrer external nofollow" target="_blank" href="'+e.view_host_link+'"><span class="span-host" style="font-weight:bold;">'+e.view_host+"</span></a>":n+='<span class="span-host" style="font-weight:bold;">'+e.view_host+"</span>",n+='<ul style="padding-left: 0px;">';for(var o=0;o<t.length;o++)line=t[o],n+='<li style="margin-bottom:10px;">',n+='<div style="display: inline-block; width: 20%; line-height:87px; height:90px; text-align:center; border: 1px solid rgba(128,128,128,0.5);">',n+='<a rel="noreferrer external nofollow" href="'+line.link+'" target="_blank"><img src="'+line.img_link+'" style="vertical-align: middle; max-width:100%; max-height:100%"></a></div>',n+='<div class="priced_item_left" style="margin-left:1%; width:78%">',"v_right1"in line&&(n+='<div class="priced_item_right" style="width:120px"><span style="display:inline-block;float:right;">',"v_right2"in line&&("v_right2_link"in line?n+='<a rel="noreferrer external nofollow" target="_blank" href="'+line.v_right2_link+'"><span style="background-color: #A0522D;font-size: small;color: white;padding: 0px 2px;border-radius: 2px 2px;">'+line.v_right2+"</span></a>":n+='<span style="background-color: #A0522D;font-size: small;color: white;padding: 0px 2px;border-radius: 2px 2px;">'+line.v_right2+"</span>"),n+='<span style="background-color: #A0522D;font-size: small;color: white;padding: 0px 2px;margin-left: 5px;border-radius: 2px 2px;">'+line.v_right1+"</span></div>"),n+='<div class="title" style="line-height:1.5em; max-height:3em;"><a rel="noreferrer external nofollow" target="_blank" href="'+t[o].link+'" style="font-weight: bold;"><span width="100%">'+t[o].title+"</span></a></div>",n+='<div class="des" style="line-height:1.3em; max-height:3.7em;">'+line.v_des+"</div>",n+="</li>";return n+="</ul></div>"}function split_panel(){var e=document.getElementById("forum-div"),t=document.getElementById("forum-panel-not-ads"),n=document.getElementById("google-panel"),o=document.getElementById("result-panel-middle");"google-panel-width-backup"!==n.getAttribute("class")&&n.setAttribute("class","google-panel-width-narrow"),e.style.display="",t.style.display="inline-block",o.setAttribute("class","result-panel-middle-show"),document.getElementById("priced-filter").innerHTML="FORUM & PRINTED BOOK"}function notfound_alert(){hide_loading();var e=document.getElementById("SearchWord").value,t='<div style="font-size: 16px;"><br>没有找到与<b>"'+e+'"</b>相关的文档.<br>可以减少搜索限制或换个名字尝试.</div>';t+='<div style="font-size: 16px;"><br><b>'+e+'</b> - is not found.<br><br>Suggestions: <br><ul style="line-height: 1.2;margin-top: 10px;"><li>Make sure all words are spelled correctly.</li><li>Try different keywords.</li><li>Try more general keywords.</li></ul></div>',document.getElementById("result-ul").innerHTML=t}function exceed_alert(){document.getElementById("result-ul").innerHTML='<div style="font-size: 16px;"><br><span style="font-weight:bold;">Information</span><br><br> - You have reached search limits today, some results will not be able to show. Please try again tomorrow. Thanks.</div><div style="font-size: 17px;"><br><span style="font-size: 18px; font-weight:bold">提示</span><br><br> - 您的查询已达到今日的最高次数, 一些结果将无法显示. 请明日再试. 谢谢.</div>'}function tooshort_alert(){document.getElementById("result-ul").innerHTML='<div style="font-size: 16px;"><br><span style="font-weight:bold;">Information</span><br><br> - Invalid Search. Please try again. Thanks.</div><div style="font-size: 17px;"><br><span style="font-size: 18px; font-weight:bold">提示</span><br><br> - 您查询的内容过短, 请重试. 谢谢.</div>'}function filter_content(e){for(var t=document.getElementById("result-ul"),n=document.getElementById("google-div"),o=document.getElementById("format-filter").getElementsByTagName("a"),i=0;i<o.length;i++)o[i].getAttribute("id")===e?o[i].setAttribute("style","font-weight: bolder;"):o[i].setAttribute("style","font-weight: normal;");for(var r=[],r=e===format_other?filter_other():filter_format(e),a="",i=0;i<r.length;i++)a+=render_main(r[i]);return t.innerHTML=a,n.scrollTop=0,!(dls_show=[])}function filter_format(e){for(var t=get_format_exp(e),n=[],o=0;o<view.length;o++){var i,r,a,l,s=!1;(view[o].title.match(t)||view[o].des.match(t))&&(s=!0),s&&(r=(i=Object.assign({},view[o])).title,a=i.des,l='<span class="highlight">'+r.match(t)+"</span>",s='<span class="highlight">'+a.match(t)+"</span>",i.replaced_title=r.split(t).join(l),i.replaced_des=a.split(t).join(s),n.push(i))}return n}function filter_other(){for(var e=[],t=0;t<view.length;t++){for(var n=!1,o=0;o<format.length;o++)if(view[t].title.match(format_exp[o])||view[t].des.match(format_exp[o])){n=!0;break}n||e.push(view[t])}return e}function hide_loading(){var e=document.getElementById("format-filter");e&&(e.style.display="inline-block");e=document.getElementById("format-loading");e&&(e.style.display="none");e=document.getElementById("loading-icon");e&&(e.style.display="none");e=document.querySelector("#loading-icon img");e&&(e.style="")}function more_loading(){var e=document.getElementById("format-filter");e&&(e.style.display="none");e=document.getElementById("format-loading");e&&(e.style.display="inline-block");e=document.querySelector("#loading-icon img");e&&(e.style.width="35px")}function localbook_click(e){for(var t=e.parentElement.parentElement.querySelectorAll(".localbook_download"),n=0;n<t.length;n++){var o=t[n],i=dls_show.indexOf(o.href);0<=i?dls_show.splice(i,1):dls_show.push(o.href)}return localbook_refresh(),!1}function localbook_refresh(){for(var e=document.querySelectorAll(".localbook_download"),t=0;t<e.length;t++)0<=dls_show.indexOf(e[t].href)?e[t].style.display="inline-block":e[t].style.display="none"}function wechat_overlay_load(){return document.body&&(document.body.innerHTML+='<div id="wechat-overlay" onclick="wechat_overlay_hide();" style="display:none; position: absolute; width: 100%; height: 100%; top: 0px; left: 0px; z-index: 100; text-align:center; vertical-align:middle; background-color: rgba(0,0,0,0); padding-top: 150px;"><img style="max-width:100%; border: solid 2px grey; border-radius: 5px 5px;" src="images/wechat_public_barcode3.gif"></div>'),!0}function wechat_overlay_show(){var e=document.getElementById("wechat-overlay");return!e||!(e.style.display="block")}function wechat_overlay_hide(){var e=document.getElementById("wechat-overlay");return e&&(e.style.display="none"),!0}function prom_overlay_load(){if(!document.body)return!0;var e=document.getElementById("notification");if(!e)return!0;if("none"===e.style.display)return!0;var t=document.getElementById("prom-share");if(!t)return!0;e=t.getAttribute("data-mark");if(!e)return!0;t=t.getAttribute("data-pic");if(!t)return!0;g_prom_mark=e;t='<div id="prom-overlay" onclick="prom_overlay_hide();" style="display:none; position: absolute; width: 100%; height: 100%; top: 0px; left: 0px; z-index: 100; text-align:center; vertical-align:middle; background-color: rgba(0,0,0,0); padding-top: 150px;"><img style="max-width:100%; border: solid 2px grey; border-radius: 5px 5px;" src="'+t+'"></div>';return document.body.innerHTML+=t,!0}function prom_overlay_clicked(){setCookie("jmprom",g_prom_mark,9999);var e=new XMLHttpRequest;return e.open("POST","prom_clicked.php",!0),e.setRequestHeader("Content-type","application/x-www-form-urlencoded"),e.setRequestHeader("X-Requested-With","XMLHttpRequest"),e.send("q="+encodeURIComponent(g_prom_mark)+"&g_device="+g_device),!1}function prom_overlay_show(){var e=document.getElementById("prom-overlay");return!e||(e.style.display="block",prom_overlay_clicked(),!1)}function prom_overlay_hide(){var e=document.getElementById("prom-overlay");return e&&(e.style.display="none"),!0}var g_loop_count_max=60,g_loop_count=0,g_h_loop="";function open_href_noreferrer(e){var t=document.createElement("a");t.setAttribute("href",e),t.setAttribute("target","_blank"),t.setAttribute("rel","noreferrer external nofollow"),document.body.appendChild(t),t.click(),t.parentNode&&t.parentNode.removeChild(t)}function create_href_loading(e){var t;"pc"===g_device?(document.body.style.cursor="wait",e.style.cursor="wait"):((t=document.createElement("img")).src="images/loading_bright.gif",t.style="height:20px; margin-left:5px; vertical-align:bottom; margin-bottom:2px;",e.appendChild(t))}function remove_href_loading(e){var t;"pc"===g_device?(document.body.style.cursor="default",e.style.cursor="pointer"):(t=e.querySelector("img"))&&e.removeChild(t)}function show_zip_tip(e){is_zip_rar(e)&&(document.getElementById("van-expired").style.display="block")}var g_ticket_receiving=!1;function wxp_overlay_show(a){var l=a.getAttribute("data-title"),s=a.getAttribute("data-href"),e=document.createElement("a");e.href=s;var t,n=e.hostname;if(!is_show_barcode(n))return is_zip_rar(l)?(t=document.getElementById("van-overlay"),e=document.getElementById("van-dialog"),t.style.display="block",e.style.display="block",n=document.getElementById("van-content"),t=document.getElementById("van-tip"),e=document.getElementById("van-href"),n.style.display="none",t.style.display="none",e.setAttribute("data-href",s),e.innerHTML="点我前往下载页面。",e.style.display="block",show_zip_tip(l)):open_href_noreferrer(s),!1;if(g_ticket_receiving)return!1;var d=new XMLHttpRequest;return d.onreadystatechange=function(){if(4===d.readyState&&200===d.status){if(!g_ticket_receiving)return;g_ticket_receiving=!1,remove_href_loading(a);var e,t,n,o,i,r=d.responseText;0<=r.indexOf("--succeed--")?(e=(i=r.split("--succeed--"))[0],n=i[1],t=i[2],setCookie("jmwxsi",e,9999),c_log(r),o=document.getElementById("van-overlay"),i=document.getElementById("van-dialog"),document.getElementById("van-img").src="https://mp.weixin.qq.com/cgi-bin/showqrcode?ticket="+t,t=document.getElementById("van_clock_num"),clearTimeout(g_h_loop),g_loop_count=0,g_h_loop="",t.innerHTML=2*g_loop_count_max,o.style.display="block",i.style.display="block",wxp_loop(s,l,e,n)):(o=document.getElementById("van-overlay"),i=document.getElementById("van-dialog"),o.style.display="block",i.style.display="block",n=document.getElementById("van-content"),o=document.getElementById("van-tip"),i=document.getElementById("van-href"),n.style.display="none",o.style.display="none",i.setAttribute("data-href",s),i.style.display="block",show_zip_tip(l))}4===d.readyState&&500<=d.status&&c_log("getting ticket request network fail")},d.open("POST","/wxpush/get_ticket.php",!0),d.setRequestHeader("Content-type","application/x-www-form-urlencoded"),d.send("jmwxsi="+encodeURIComponent(getCookie("jmwxsi"))+"&g_device="+g_device),g_ticket_receiving=!0,create_href_loading(a),c_log("getting ticket"),setTimeout(function(){{if(!g_ticket_receiving)return;g_ticket_receiving=!1,remove_href_loading(a)}d.abort(),c_log("xmlhttp get_ticket timeout");var e=document.getElementById("van-overlay"),t=document.getElementById("van-dialog");e.style.display="block",t.style.display="block";var n=document.getElementById("van-content"),e=document.getElementById("van-tip"),t=document.getElementById("van-href");n.style.display="none",e.style.display="none",t.setAttribute("data-href",s),t.style.display="block",show_zip_tip(l)},3e3),!1}function wxp_overlay_hide(){var e=document.getElementById("van-overlay"),t=document.getElementById("van-dialog"),n=document.getElementById("van-img"),o=document.getElementById("van-content"),i=document.getElementById("van-tip"),r=document.getElementById("van-href"),a=document.getElementById("van-expired");return document.getElementById("van_clock_num").innerHTML="",n.src="",e.style.display="none",t.style.display="none",o.style.display="block",i.style.display="none",r.setAttribute("data-href",""),r.style.display="none",a.style.display="none",clearTimeout(g_h_loop),g_loop_count=0,!(g_h_loop="")}function wxp_loop(i,r,a,l){var s=!1,d=new XMLHttpRequest;return d.onreadystatechange=function(){if(4===d.readyState&&200===d.status){if(s)return;s=!0;var e,t=d.responseText;if(!(0<=t.indexOf("succeed")))return void(g_loop_count<g_loop_count_max?(e=document.getElementById("van_clock_num"),n=2*(g_loop_count_max-g_loop_count-1),g_loop_count++,e.innerHTML=n,n=document.getElementById("van-content"),g_h_loop=setTimeout(function(){wxp_loop(i,r,a,l)},2e3)):(g_loop_count=0,n=document.getElementById("van-content"),o=document.getElementById("van-tip"),n.style.display="none",o.style.display="block",c_log("loop failed count max")));c_log(t),g_wxp_svi="all",clearTimeout(g_h_loop),g_loop_count=0,g_h_loop="";var n=document.getElementById("van-content"),o=document.getElementById("van-tip"),t=document.getElementById("van-href");n.style.display="none",o.style.display="none",t.setAttribute("data-href",i),t.style.display="block",show_zip_tip(r)}4===d.readyState&&500<=d.status&&c_log("getting ticket request network fail")},d.open("POST","/wxpush/loop_check.php",!0),d.setRequestHeader("Content-type","application/x-www-form-urlencoded"),d.send("jmwxsi="+a+"&svi="+l),c_log("looping"),setTimeout(function(){{if(s)return;s=!0}d.abort(),c_log("xmlhttp loop_check timeout"),clearTimeout(g_h_loop),g_loop_count=0,g_h_loop="";var e=document.getElementById("van-content"),t=document.getElementById("van-tip"),n=document.getElementById("van-href");e.style.display="none",t.style.display="none",n.setAttribute("data-href",i),n.style.display="block",show_zip_tip(r)},6e3),!1}function wxp_overlay_direct(e){e=e.getAttribute("data-href");return wxp_overlay_hide(),open_href_noreferrer(e),!1}